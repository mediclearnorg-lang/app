<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body { 
            background: #000; 
            color: #fff; 
            font-family: 'Vazirmatn', sans-serif; 
            padding: 20px; 
            text-align: center; 
        }
        .card { 
            background: #111; 
            padding: 20px; 
            border-radius: 12px; 
            border: 1px solid #333; 
            margin-bottom: 20px; 
        }
        .hl { color: #FFD700; font-weight: bold; }
        .btn { 
            background: #FFD700; 
            color: #000; 
            border: none; 
            padding: 12px; 
            width: 100%; 
            border-radius: 8px; 
            font-weight: bold; 
            font-family: 'Vazirmatn', sans-serif;
            margin-top: 10px; 
            cursor: pointer; 
            font-size: 16px;
        }
        .btn-outline { 
            background: transparent; 
            border: 1px solid #FFD700; 
            color: #FFD700; 
        }
        input { 
            width: 90%; 
            padding: 12px; 
            border-radius: 8px; 
            border: 1px solid #444; 
            background: #222; 
            color: #fff; 
            text-align: center; 
            font-size: 18px; 
            font-family: 'Vazirmatn', sans-serif;
            margin-bottom: 10px; 
            direction: ltr; /* برای عدد نویسی انگلیسی */
        }
        h2, h4 { margin: 10px 0; }
    </style>
</head>
<body>
    <h2>Mining Pips <span class="hl">HUB</span></h2>
    
    <div class="card">
        <div style="font-size: 13px; color: #888;">موجودی کیف پول</div>
        <div style="font-size: 36px; direction: ltr;" class="hl" id="bal">...</div>
        <div id="status" style="margin-top:5px; font-size:14px;"></div>
    </div>

    <div class="card">
        <h4>شارژ حساب (تتر/اتریوم)</h4>
        <input type="number" id="amt" placeholder="مبلغ به دلار (مثلاً 50)">
        <button class="btn" onclick="reqDeposit()">شروع شارژ</button>
    </div>

    <div class="card">
        <h4>خرید اشتراک VIP</h4>
        <button class="btn btn-outline" onclick="buy('14')">14 روزه (<span id="p14">--</span>)</button>
        <button class="btn btn-outline" onclick="buy('30')">30 روزه (<span id="p30">--</span>)</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        const p = new URLSearchParams(window.location.search);

        // تابع کمکی برای فرمت دهی پول (2 رقم اعشار)
        function fmt(val) {
            return parseFloat(val || 0).toFixed(2);
        }

        document.getElementById("bal").innerText = "$" + fmt(p.get('bal'));
        document.getElementById("p14").innerText = "$" + fmt(p.get('p14'));
        document.getElementById("p30").innerText = "$" + fmt(p.get('p30'));
        
        const act = p.get('active') === '1';
        const st = document.getElementById("status");
        st.innerText = act ? "✅ اشتراک فعال است" : "❌ اشتراک ندارید";
        st.style.color = act ? "#0f0" : "#f00";

        function reqDeposit() {
            const val = document.getElementById("amt").value;
            if(!val || val<=0) return tg.showPopup({message: "لطفاً مبلغ معتبری وارد کنید"});
            tg.sendData("deposit:" + val);
            tg.close();
        }

        function buy(plan) {
            tg.sendData("buy:" + plan);
            tg.close();
        }
    </script>
</body>
</html>
