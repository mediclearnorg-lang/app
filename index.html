<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #050505; color: #fff; font-family: sans-serif; padding: 15px; text-align: center; }
        .card { background: #151515; padding: 15px; border-radius: 12px; border: 1px solid #333; margin-bottom: 15px; }
        .accent { color: #FFD700; font-weight: bold; }
        .btn { background: #FFD700; color: #000; border: none; padding: 12px; width: 100%; border-radius: 8px; font-weight: bold; margin-top: 8px; cursor: pointer; }
        .btn-outline { background: transparent; border: 1px solid #FFD700; color: #FFD700; }
        input { width: 90%; padding: 10px; border-radius: 8px; border: 1px solid #555; background: #222; color: #fff; text-align: center; margin-bottom: 10px; }
    </style>
</head>
<body>
    <h3>Mining Pips <span class="accent">HUB</span></h3>
    
    <div class="card">
        <div style="font-size: 12px; color: #888;">Wallet Balance</div>
        <div style="font-size: 32px;" class="accent" id="bal">Loading...</div>
        <div id="status" style="font-size: 12px; margin-top: 5px;"></div>
    </div>

    <div class="card">
        <h4>Deposit Funds</h4>
        <input type="number" id="dep-amount" placeholder="Enter amount in USD (e.g. 50)">
        <button class="btn" onclick="requestDeposit()">Start Deposit</button>
    </div>

    <div class="card">
        <h4>Buy Membership</h4>
        <button class="btn btn-outline" onclick="buyPlan('14')">14 Days (<span id="p14">--</span>)</button>
        <button class="btn btn-outline" onclick="buyPlan('30')">30 Days (<span id="p30">--</span>)</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        const p = new URLSearchParams(window.location.search);

        // پر کردن اطلاعات از لینک
        document.getElementById("bal").innerText = "$" + (p.get('bal') || "0.00");
        document.getElementById("p14").innerText = "$" + (p.get('p14') || "--");
        document.getElementById("p30").innerText = "$" + (p.get('p30') || "--");
        
        const active = p.get('active') === '1';
        document.getElementById("status").innerText = active ? "✅ VIP ACTIVE" : "❌ INACTIVE";
        document.getElementById("status").style.color = active ? "#4cd964" : "#ff3b30";

        // ارسال درخواست واریز به ربات
        function requestDeposit() {
            const amount = document.getElementById("dep-amount").value;
            if (!amount || amount <= 0) {
                tg.showPopup({message: "Please enter a valid amount."});
                return;
            }
            // ارسال دیتا به پایتون: "deposit:50"
            tg.sendData("deposit:" + amount);
            tg.close();
        }

        // ارسال درخواست خرید
        function buyPlan(days) {
            tg.sendData("buy:" + days);
            tg.close();
        }
    </script>
</body>
</html>
